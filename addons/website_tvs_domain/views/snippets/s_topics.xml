<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <!-- Snippet -->
    <template id="s_topics" name="Domain Topics">
        <t t-call="website.s_dynamic_snippet_template">
            <t t-set="snippet_name" t-value="'s_topics'"/>
            <t t-set="snippet_classes" t-value="'s_dynamic_snippet_topics'"/>
        </t>
    </template>

    <!-- Load-time templates (rendered in JS on page load) -->
    <!-- template id must have the format: 'dynamic_filter_template_' + 'model name replace . by _' + 'extra'   -->
    <!-- Layout -->
    <template id="dynamic_filter_template_tvs_topic_layout" name="Topic Layout">
        <div t-foreach="records" t-as="data" class="w-100 d-grid" data-number-of-elements="3">
            <t t-set="record" t-value="data['_record']"/>
            <div class="s_topics_section">
                <div class="s_topics_icon d-flex align-items-center gap-3">
                    <img t-if="record.icon" t-att-src="'data:image/svg+xml;base64,' + record.icon.decode('utf-8')"/>
                    <span t-field="record.title"/>
                </div>
                <div class="s_topics_text mt-3">
                    <h6 t-esc="record.get_short_description()"/>
                </div>
                <div class="s_topics_button mt-3">
                    <a data-bs-toggle="modal" t-attf-data-bs-target="#topic-{{record.id}}">
                        <h6>View More</h6>
                    </a>
                </div>
                <!-- Modal -->
                <div class="modal fade" t-attf-id="topic-{{record.id}}" tabindex="-1"
                     aria-labelledby="topicModalLabel" aria-hidden="true">
                    <div class="modal-dialog modal-dialog-centered modal-lg">
                        <div class="modal-content">
                            <div class="modal-body">
                                <div class="d-flex justify-content-end">
                                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"/>
                                </div>
                                <div class="modal-title d-flex align-items-center gap-2 px-4">
                                    <img t-if="record.icon"
                                         t-att-src="'data:image/svg+xml;base64,' + record.icon.decode('utf-8')"/>
                                    <h2 t-field="record.title"/>
                                </div>
                                <div class="modal-text p-4">
                                    <t t-esc="record.description" />
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </template>

    <!-- Options -->
    <template id="s_topics_options" inherit_id="website.snippet_options">
        <xpath expr="." position="inside">
            <t t-call="website_tvs_domain.s_topics_options_template">
                <t t-set="snippet_name" t-value="'dynamic_snippet_topics'"/>
                <t t-set="snippet_selector" t-value="'.s_dynamic_snippet_topics'"/>
            </t>
        </xpath>
    </template>

    <template id="s_topics_options_template" inherit_id="website.s_dynamic_snippet_options_template">
        <xpath expr="//we-select[@data-name='filter_opt']" position="after">
            <we-select t-if="snippet_name == 'dynamic_snippet_topics'" string="Domain" data-no-preview="true"
                       data-name="domain_opt" data-attribute-name="filterByDomainId">
                <we-button data-select-data-attribute="-1">All topics</we-button>
                <!-- the blog list will be generated in js -->
            </we-select>
        </xpath>
    </template>

    <!-- Assets -->
    <record id="website_tvs_domain.s_topics_000_scss" model="ir.asset">
        <field name="name">Topics 000 SCSS</field>
        <field name="bundle">web.assets_frontend</field>
        <field name="path">website_tvs_domain/static/src/snippets/s_topics/000.scss</field>
    </record>
    <record id="website_tvs_domain.s_topics_000_js" model="ir.asset">
        <field name="name">Topics 000 JS</field>
        <field name="bundle">web.assets_frontend</field>
        <field name="path">website_tvs_domain/static/src/snippets/s_topics/000.js</field>
    </record>
</odoo>
